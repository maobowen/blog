<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=2">
<meta name="theme-color" content="#222">
<meta name="generator" content="Hexo 4.2.1">
  <link rel="apple-touch-icon" sizes="180x180" href="/blog/images/apple-touch-icon-next.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/blog/images/favicon-32x32-next.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/blog/images/favicon-16x16-next.png">
  <link rel="mask-icon" href="/blog/images/logo.svg" color="#222">
  <meta http-equiv="Cache-Control" content="no-transform">
  <meta http-equiv="Cache-Control" content="no-siteapp">

<link rel="stylesheet" href="/blog/css/main.css">


<link rel="stylesheet" href="//cdn.jsdelivr.net/npm/font-awesome@4.7.0/css/font-awesome.min.css">
  <link rel="stylesheet" href="//cdn.jsdelivr.net/gh/fancyapps/fancybox@3/dist/jquery.fancybox.min.css">
  <link rel="stylesheet" href="//cdn.jsdelivr.net/npm/pace-js@1.0.2/themes/blue/pace-theme-minimal.css">
  <script src="//cdn.jsdelivr.net/npm/pace-js@1.0.2/pace.min.js"></script>


<script id="hexo-configurations">
  var NexT = window.NexT || {};
  var CONFIG = {
    hostname: new URL('http://bmao.tech/blog').hostname,
    root: '/blog/',
    scheme: 'Pisces',
    version: '7.6.0',
    exturl: false,
    sidebar: {"position":"left","display":"post","padding":18,"offset":12,"onmobile":false},
    copycode: {"enable":true,"show_result":true,"style":null},
    back2top: {"enable":true,"sidebar":false,"scrollpercent":true},
    bookmark: {"enable":false,"color":"#222","save":"auto"},
    fancybox: true,
    mediumzoom: false,
    lazyload: true,
    pangu: false,
    comments: {"style":"tabs","active":null,"storage":true,"lazyload":false,"nav":null},
    algolia: {
      appID: '',
      apiKey: '',
      indexName: '',
      hits: {"per_page":10},
      labels: {"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}
    },
    localsearch: {"enable":true,"trigger":"auto","top_n_per_article":1,"unescape":false,"preload":false},
    path: 'search.xml',
    motion: {"enable":true,"async":false,"transition":{"post_block":"fadeIn","post_header":"slideDownIn","post_body":"slideDownIn","coll_header":"slideLeftIn","sidebar":"slideUpIn"}}
  };
</script>

  <meta name="description" content="I previously hosted two of my Django projects, NoteShare and Anime, on IBM Cloud. Now, I have decided to switch to Heroku, but the migration is not that straightforward. This article introduces how to">
<meta property="og:type" content="article">
<meta property="og:title" content="Deploying PyCharm-Created Django Project on Heroku">
<meta property="og:url" content="http://bmao.tech/blog/django-pycharm-on-heroku/index.html">
<meta property="og:site_name" content="101对双生儿&#39;s Blog">
<meta property="og:description" content="I previously hosted two of my Django projects, NoteShare and Anime, on IBM Cloud. Now, I have decided to switch to Heroku, but the migration is not that straightforward. This article introduces how to">
<meta property="og:locale" content="en_US">
<meta property="article:published_time" content="2020-02-29T01:00:00.000Z">
<meta property="article:modified_time" content="2020-05-30T07:42:41.575Z">
<meta property="article:author" content="101对双生儿">
<meta property="article:tag" content="Python">
<meta property="article:tag" content="Heroku">
<meta name="twitter:card" content="summary">

<link rel="canonical" href="http://bmao.tech/blog/django-pycharm-on-heroku/">


<script id="page-configurations">
  // https://hexo.io/docs/variables.html
  CONFIG.page = {
    sidebar: "",
    isHome: false,
    isPost: true
  };
</script>

  <title>Deploying PyCharm-Created Django Project on Heroku | 101对双生儿's Blog</title>
  






  <noscript>
  <style>
  .use-motion .brand,
  .use-motion .menu-item,
  .sidebar-inner,
  .use-motion .post-block,
  .use-motion .pagination,
  .use-motion .comments,
  .use-motion .post-header,
  .use-motion .post-body,
  .use-motion .collection-header { opacity: initial; }

  .use-motion .site-title,
  .use-motion .site-subtitle {
    opacity: initial;
    top: initial;
  }

  .use-motion .logo-line-before i { left: initial; }
  .use-motion .logo-line-after i { right: initial; }
  </style>
</noscript>

</head>

<body itemscope itemtype="http://schema.org/WebPage">
  <div class="container use-motion">
    <div class="headband"></div>

    <header class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-container">
  <div class="site-meta">

    <div>
      <a href="/blog/" class="brand" rel="start">
        <span class="logo-line-before"><i></i></span>
        <span class="site-title">101对双生儿's Blog</span>
        <span class="logo-line-after"><i></i></span>
      </a>
    </div>
        <p class="site-subtitle">Not pleased by external gains. Not saddened by personal losses.</p>
  </div>

  <div class="site-nav-toggle">
    <div class="toggle" aria-label="Toggle navigation bar">
      <span class="toggle-line toggle-line-first"></span>
      <span class="toggle-line toggle-line-middle"></span>
      <span class="toggle-line toggle-line-last"></span>
    </div>
  </div>
</div>


<nav class="site-nav">
  
  <ul id="menu" class="menu">
        <li class="menu-item menu-item-home">

    <a href="/blog/." rel="section"><i class="fa fa-fw fa-home"></i>Home</a>

  </li>
        <li class="menu-item menu-item-tags">

    <a href="/blog/tags/" rel="section"><i class="fa fa-fw fa-tags"></i>Tags<span class="badge">14</span></a>

  </li>
        <li class="menu-item menu-item-categories">

    <a href="/blog/categories/" rel="section"><i class="fa fa-fw fa-th"></i>Categories<span class="badge">4</span></a>

  </li>
        <li class="menu-item menu-item-archives">

    <a href="/blog/archives/" rel="section"><i class="fa fa-fw fa-archive"></i>Archives<span class="badge">12</span></a>

  </li>
        <li class="menu-item menu-item-resume">

    <a href="/blog/resume/" rel="section"><i class="fa fa-fw fa-file-text"></i>Résumé</a>

  </li>
        <li class="menu-item menu-item-referrals">

    <a href="/blog/referrals/" rel="section"><i class="fa fa-fw fa-share"></i>Referrals</a>

  </li>
      <li class="menu-item menu-item-search">
        <a role="button" class="popup-trigger"><i class="fa fa-search fa-fw"></i>Search
        </a>
      </li>
  </ul>

</nav>
  <div class="site-search">
    <div class="popup search-popup">
    <div class="search-header">
  <span class="search-icon">
    <i class="fa fa-search"></i>
  </span>
  <div class="search-input-container">
    <input autocomplete="off" autocorrect="off" autocapitalize="none"
           placeholder="Searching..." spellcheck="false"
           type="text" id="search-input">
  </div>
  <span class="popup-btn-close">
    <i class="fa fa-times-circle"></i>
  </span>
</div>
<div id="search-result"></div>

</div>
<div class="search-pop-overlay"></div>

  </div><!-- Global APlayer -->
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/aplayer/dist/APlayer.min.css">
<script type="text/javascript" src="https://cdn.jsdelivr.net/npm/aplayer/dist/APlayer.min.js"></script>
<script type="text/javascript" src="https://cdn.jsdelivr.net/npm/meting/dist/Meting.min.js"></script>
<meting-js
  auto="https://music.163.com/#/playlist?id=648989969"
  list-folded="true"
  fixed="true"
  lrc-type="0">
</meting-js>

</div>
    </header>

    
  <div class="back-to-top">
    <i class="fa fa-arrow-up"></i>
    <span>0%</span>
  </div>
  <div class="reading-progress-bar"></div>


    <main class="main">
      <div class="main-inner">
        <div class="content-wrap">
          

          <div class="content">
            

  <div class="posts-expand">
      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block " lang="en">
    <link itemprop="mainEntityOfPage" href="http://bmao.tech/blog/django-pycharm-on-heroku/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="https://tvax4.sinaimg.cn/crop.0.0.568.568.180/6e363801ly8fgtxq4arklj20fs0fsdh8.jpg">
      <meta itemprop="name" content="101对双生儿">
      <meta itemprop="description" content="A blog of a computer science student.">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="101对双生儿's Blog">
    </span>
      <header class="post-header">
        <h1 class="post-title" itemprop="name headline">
          Deploying PyCharm-Created Django Project on Heroku
        </h1>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              <span class="post-meta-item-text">Posted on</span>

              <time title="Created: 2020-02-28 17:00:00" itemprop="dateCreated datePublished" datetime="2020-02-28T17:00:00-08:00">2020-02-28</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="fa fa-calendar-check-o"></i>
                </span>
                <span class="post-meta-item-text">Edited on</span>
                <time title="Modified: 2020-05-30 00:42:41" itemprop="dateModified" datetime="2020-05-30T00:42:41-07:00">2020-05-30</time>
              </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              <span class="post-meta-item-text">In</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/blog/categories/996-ICU/" itemprop="url" rel="index">
                    <span itemprop="name">996.ICU</span>
                  </a>
                </span>
            </span>

          
  
  <span class="post-meta-item">
    
      <span class="post-meta-item-icon">
        <i class="fa fa-comment-o"></i>
      </span>
      <span class="post-meta-item-text">Disqus: </span>
    
    <a title="disqus" href="/blog/django-pycharm-on-heroku/#comments" itemprop="discussionUrl">
      <span class="post-comments-count disqus-comment-count" data-disqus-identifier="django-pycharm-on-heroku/" itemprop="commentCount"></span>
    </a>
  </span>
  
  <br>
            <span class="post-meta-item" title="Symbols count in article">
              <span class="post-meta-item-icon">
                <i class="fa fa-file-word-o"></i>
              </span>
                <span class="post-meta-item-text">Symbols count in article: </span>
              <span>6.8k</span>
            </span>
            <span class="post-meta-item" title="Reading time">
              <span class="post-meta-item-icon">
                <i class="fa fa-clock-o"></i>
              </span>
                <span class="post-meta-item-text">Reading time &asymp;</span>
              <span>6 mins.</span>
            </span>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
        <p>I previously hosted two of my <a href="https://docs.djangoproject.com/" target="_blank" rel="noopener">Django</a> projects, <a href="https://github.com/maobowen/noteshare_django" target="_blank" rel="noopener">NoteShare</a> and <a href="https://github.com/maobowen/anime_django" target="_blank" rel="noopener">Anime</a>, on <a href="https://www.ibm.com/cloud" target="_blank" rel="noopener">IBM Cloud</a>. Now, I have decided to switch to <a href="https://www.heroku.com" target="_blank" rel="noopener">Heroku</a>, but the migration is not that straightforward. This article introduces how to deploy a Django project, created by <a href="https://www.jetbrains.com/pycharm/" target="_blank" rel="noopener">PyCharm</a>, on Heroku.</p>
<a id="more"></a>
<h2 id="why-i-made-this-switch">Why I Made This Switch</h2>
<p>IBM Cloud, previously called IBM Bluemix, is a Platform-as-a-Service (PaaS) based on <a href="https://www.cloudfoundry.org/" target="_blank" rel="noopener">Cloud Foundry</a>. It provides free Lite accounts, but <a href="https://cloud.ibm.com/docs/account?topic=account-accounts#lite-account-features" target="_blank" rel="noopener">the limitations of those free accounts</a> are super inconvenient:</p>
<ul>
<li>After 10 days of no development activity, your apps go to sleep.</li>
<li>After 30 days of no development activity, your service instances with Lite plans are deleted.</li>
</ul>
<p>Having these rules means that I have to frequently update my projects even if I don't need to. More interestingly, once an app goes to sleep, I must either push new code or log into the console to re-activate it. Therefore, I decided to switch to <a href="https://www.heroku.com/pricing" target="_blank" rel="noopener">Heroku's free plan</a>. The free plan on Heroku also has <a href="https://devcenter.heroku.com/articles/free-dyno-hours#dyno-sleeping" target="_blank" rel="noopener">the following limitation</a>:</p>
<ul>
<li>If an app has a free web dyno, and that dyno receives no web traffic in a 30-minute period, it will sleep.</li>
</ul>
<p>However, I can simply re-activate the app by visiting the URL of it. If you really want your app being online during most of the time in a day, you always have <a href="https://medium.com/better-programming/keeping-my-heroku-app-alive-b19f3a8c3a82" target="_blank" rel="noopener">other options</a> available. (By the way, it is <a href="https://devcenter.heroku.com/articles/free-dyno-hours#usage" target="_blank" rel="noopener">not possible</a> to make the free dynos always online.)</p>
<h2 id="differences-between-ibm-cloud-and-heroku">Differences Between IBM Cloud and Heroku</h2>
<p>To me, there are two major differences.</p>
<ul>
<li>Cloud Foundry uses <code>.cfignore</code> to determine which files should be excluded from upload. This file can be different from <code>.gitignore</code> which determines which files should be excluded from the Git repository. This gives me more freedom of maintaining files in a project. For example, I don't want to ruin my repository by adding super large SQLite database file or numerous subtitle files of anime episodes. I don't want to push the credentials of the project to GitHub, too, but I want them available in the cloud. To deal with these cases, I could simply include those files in <code>.gitignore</code> but not in <code>.cfignore</code> in the past. However, on Heroku I don't have that level of control.</li>
<li>Heroku's <a href="https://devcenter.heroku.com/articles/dynos#ephemeral-filesystem" target="_blank" rel="noopener">ephemeral filesystem</a> makes it <a href="https://devcenter.heroku.com/articles/sqlite3" target="_blank" rel="noopener">impossible to use file-based SQLite database</a>, as I just explained that SQLite database will not and should not be added to the repository. Therefore, I must switch to some database systems such as Postgres or MySQL, and actually Heroku provides bunch of <a href="https://elements.heroku.com/addons#data-stores" target="_blank" rel="noopener">database add-ons</a>. In addition, I cannot have any dynamically-generated files in the projects.</li>
</ul>
<p>Therefore, I cannot directly push the projects to Heroku directly. Many changes must be made before doing that.</p>
<h2 id="setting-up-a-new-django-project-using-pycharm">Setting Up a New Django Project Using PyCharm</h2>
<p>Since there are lots of changes to my out-dated projects (which haven't been maintained for a long time since my app on IBM Cloud was deleted) and I forgot the process of setting up Django projects, I decided to deploy a new one using PyCharm. The following tutorial assumes that:</p>
<ul>
<li>A Python environment for Django has been set up;</li>
<li>Heroku CLI has been installed and configured;</li>
<li>Postgres has been installed locally and a clean database has been created;</li>
<li>A clean Django project has been created in PyCharm and the Git repository has been initialized;</li>
<li>A Heroku app has been created.</li>
</ul>
<h3 id="preparing-the-project">Preparing the Project</h3>
<p>We need at least three files in the top-level project folder.</p>
<p><code>runtime.txt</code> specifies the Python runtime the Heroku app uses. See a list of supported runtimes <a href="https://devcenter.heroku.com/articles/python-support#specifying-a-python-version" target="_blank" rel="noopener">here</a>.</p>
<p><code>Procfile</code> <a href="https://devcenter.heroku.com/articles/getting-started-with-python#define-a-procfile" target="_blank" rel="noopener">declares what command to execute to start the app</a>. Since I uses <a href="https://gunicorn.org" target="_blank" rel="noopener">Gunicorn</a> as the server, here I just have one line:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">web: gunicorn django_site.wsgi --log-file -</span><br></pre></td></tr></table></figure>
<p>where <code>django_site</code> is Django project's name and <code>--log-file -</code> means log to <code>stderr</code>.</p>
<p><code>requirements.txt</code> <a href="https://devcenter.heroku.com/articles/getting-started-with-python#declare-app-dependencies" target="_blank" rel="noopener">defines app dependencies</a>. It is recommended to run <code>pip freeze &gt; requirements.txt</code> to create it but at least those are necessary:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">Django&gt;&#x3D;3.0.0</span><br><span class="line">django-heroku&gt;&#x3D;0.3.0</span><br><span class="line">gunicorn&gt;&#x3D;20.0.0</span><br><span class="line">requests&gt;&#x3D;2.22.0</span><br><span class="line">whitenoise&gt;&#x3D;4.1.0</span><br></pre></td></tr></table></figure>
<p>Then run <code>pip install -r requirements.txt</code> to install all the dependencies locally. I would maintain packages using <code>conda</code> though.</p>
<p>In addition to those files, a <code>.gitignore</code> is also necessary. It can be easily created on <a href="https://gitignore.io" target="_blank" rel="noopener">gitignore.io</a>. You can also use <a href="https://www.gitignore.io/api/django,linux,macos,pycharm+all,python,virtualenv,visualstudiocode,windows" target="_blank" rel="noopener">mine</a>.</p>
<h3 id="modifying-projects-settings.py">Modifying Project's <code>settings.py</code></h3>
<p><code>settings.py</code> is located inside <code>django_site</code> folder. It is generated by PyCharm to <a href="https://docs.djangoproject.com/en/3.0/ref/settings/" target="_blank" rel="noopener">configure the project</a>. Here are the modifications:</p>
<p>Set <code>SECRET_KEY</code> because it should not be exposed to the public. This is critical if the repository will be pushed to some public code bases such as GitHub. So first, mark down the secret key. Then run <code>heroku config:set SECRET_KEY=&lt;secret_key&gt;</code> to set the environment variable <code>SECRET_KEY</code> on Heroku. Also, add this environment variable to any PyCharm configurations. Finally, change the code to <code>SECRET_KEY = os.environ.get('SECRET_KEY')</code> so that the app will read the key from the environment variable.</p>
<p>Set <code>DEBUG = False</code> and <code>DEBUG_PROPAGATE_EXCEPTIONS = True</code>.</p>
<p>Set <code>ALLOWED_HOSTS</code> where <code>django-site</code> is the name of the Heroku app:</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">ALLOWED_HOSTS = [</span><br><span class="line">    <span class="string">'0.0.0.0'</span>,</span><br><span class="line">    <span class="string">'127.0.0.1'</span>,</span><br><span class="line">    <span class="string">'[::1]'</span>,</span><br><span class="line">    <span class="string">'.localhost'</span>,</span><br><span class="line">    <span class="string">'django-site.herokuapp.com'</span>,</span><br><span class="line">]</span><br></pre></td></tr></table></figure>
<p>Add middleware <a href="http://whitenoise.evans.io/en/stable/" target="_blank" rel="noopener">WhiteNoise</a> by</p>
<ul>
<li>Adding <code>'whitenoise.runserver_nostatic'</code> to <code>INSTALLED_APPS</code>;</li>
<li>Adding <code>'whitenoise.middleware.WhiteNoiseMiddleware'</code> to <code>MIDDLEWARE</code> <a href="http://whitenoise.evans.io/en/stable/django.html#enable-whitenoise" target="_blank" rel="noopener">directly after the Django <code>SecurityMiddleware</code> and before all other middleware</a>;</li>
<li>Setting <code>STATICFILES_STORAGE = 'whitenoise.storage.CompressedManifestStaticFilesStorage'</code></li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">INSTALLED_APPS = [</span><br><span class="line">    <span class="string">'whitenoise.runserver_nostatic'</span>,</span><br><span class="line">    <span class="string">'django.contrib.staticfiles'</span>,</span><br><span class="line">    <span class="comment"># ...</span></span><br><span class="line">]</span><br><span class="line"></span><br><span class="line">MIDDLEWARE = [</span><br><span class="line">    <span class="string">'django.middleware.security.SecurityMiddleware'</span>,</span><br><span class="line">    <span class="string">'whitenoise.middleware.WhiteNoiseMiddleware'</span>,</span><br><span class="line">    <span class="comment"># ...</span></span><br><span class="line">]</span><br><span class="line"></span><br><span class="line">STATICFILES_STORAGE = <span class="string">'whitenoise.storage.CompressedManifestStaticFilesStorage'</span></span><br></pre></td></tr></table></figure>
<p>Set database connection. In order not to expose database URLs in the code, first add <code>import dj_database_url</code> to the very beginning of the file, then after <code>DATABASES = { ... }</code>, add the following code:</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">if</span> <span class="string">'DATABASE_URL'</span> <span class="keyword">in</span> os.environ:</span><br><span class="line">    <span class="comment"># Configure Django for DATABASE_URL environment variable.</span></span><br><span class="line">    DATABASES[<span class="string">'default'</span>] = dj_database_url.config(conn_max_age=<span class="number">600</span>)</span><br></pre></td></tr></table></figure>
<p>And don't forget to add <code>DATABASE_URL</code> environment variable to any PyCharm configurations with value <code>postgresql://localhost:5432/django_site</code> if <code>django_site</code> is the name of the local Postgres database.</p>
<p>Set <a href="https://devcenter.heroku.com/articles/django-assets" target="_blank" rel="noopener">static asset</a> variables. For example:</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">STATIC_URL = <span class="string">'/static/'</span></span><br><span class="line">STATIC_ROOT = os.path.join(BASE_DIR, <span class="string">'staticfiles'</span>)</span><br><span class="line">STATICFILES_DIRS = [</span><br><span class="line">    os.path.join(BASE_DIR, <span class="string">'static'</span>),</span><br><span class="line">]</span><br></pre></td></tr></table></figure>
<p>Make sure that <code>staticfiles</code> and <code>static</code> folders exist in the top-level folder and <code>static</code> folder is not empty (i.e., containing at least one file). Also run <code>heroku config:set DEBUG_COLLECTSTATIC=1</code> to simplify debugging collectstatic on Heroku.</p>
<p>Set <a href="https://docs.djangoproject.com/en/3.0/topics/files/" target="_blank" rel="noopener">media file</a> variables:</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">MEDIA_URL = <span class="string">'/media/'</span></span><br><span class="line">MEDIA_ROOT = os.path.join(BASE_DIR, <span class="string">'media'</span>)</span><br></pre></td></tr></table></figure>
<p>Run <code>python manage.py migrate</code> to apply migrations.</p>
<h2 id="setting-up-a-new-django-application">Setting Up a New Django Application</h2>
<p>A Django project can have multiple Django applications. When PyCharm creates the project, an application can be created at the same time. The key things here are coding <code>app/urls.py</code>, <code>app/models,py</code> and <code>app/views.py</code>, designing templates and adding static files to <code>app/static/app</code> folder. Don't forget to add the application to <code>django_site/settings.py</code> and <code>django_site/urls.py</code>.</p>
<p>When done, run the following commands to migrate schema changes and <a href="https://docs.djangoproject.com/en/3.0/howto/initial-data/" target="_blank" rel="noopener">load initial data into the local database</a> if the fixture is located at <code>app/fixtures/app.json</code>:</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">python manage.py makemigrations</span><br><span class="line">python manage.py migrate</span><br><span class="line">python manage.py loaddata app</span><br><span class="line">python manage.py collectstatic</span><br></pre></td></tr></table></figure>
<h2 id="pushing-the-project-to-heroku">Pushing the Project to Heroku</h2>
<p>We need to push both the local database and the local code repository to Heroku. I use <a href="https://www.heroku.com/postgres" target="_blank" rel="noopener">Heroku Postgres add-on</a> and have attached it to the Heroku app, so I just need to do:</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">heroku git:remote -a django-site</span><br><span class="line">heroku pg:push postgresql://localhost:5432/django_site &lt;postgresql_addon&gt;</span><br><span class="line">git push heroku master</span><br></pre></td></tr></table></figure>
<h2 id="references">References</h2>
<ol type="1">
<li>Harman Deep Singh, &quot;Deploying Django App on Heroku with Postgres as Backend,&quot; <em>Medium</em>. [Online]. Available: <a href="https://medium.com/%40hdsingh13/b2f3194e8a43" target="_blank" rel="noopener">https://medium.com/%40hdsingh13/b2f3194e8a43</a>.</li>
</ol>

    </div>

    
    
    
        <div class="reward-container">
  <div></div>
  <button disable="enable" onclick="var qr = document.getElementById(&quot;qr&quot;); qr.style.display = (qr.style.display === 'none') ? 'block' : 'none';">
    Donate
  </button>
  <div id="qr" style="display: none;">
      
      <div style="display: inline-block;">
        <img src="/blog/images/rewards_wechatpay.png" alt="101对双生儿 WeChat Pay">
        <p>WeChat Pay</p>
      </div>
      
      <div style="display: inline-block;">
        <img src="/blog/images/rewards_alipay.png" alt="101对双生儿 Alipay">
        <p>Alipay</p>
      </div>
      
      <div style="display: inline-block;">
        <img src="/blog/images/rewards_venmo.png" alt="101对双生儿 Venmo">
        <p>Venmo</p>
      </div>

  </div>
</div>

        

<div>
<ul class="post-copyright">
  <li class="post-copyright-author">
    <strong>Post author:  </strong>101对双生儿
  </li>
  <li class="post-copyright-link">
    <strong>Post link: </strong>
    <a href="http://bmao.tech/blog/django-pycharm-on-heroku/" title="Deploying PyCharm-Created Django Project on Heroku">http://bmao.tech/blog/django-pycharm-on-heroku/</a>
  </li>
  <li class="post-copyright-license">
    <strong>Copyright Notice:  </strong>All articles in this blog are licensed under <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/" rel="noopener" target="_blank"><i class="fa fa-fw fa-creative-commons"></i>BY-NC-SA</a> unless stating additionally.
  </li>
</ul>
</div>


      <footer class="post-footer">
          
          <div class="post-tags">
              <a href="/blog/tags/Python/" rel="tag"><i class="fa fa-tag"></i> Python</a>
              <a href="/blog/tags/Heroku/" rel="tag"><i class="fa fa-tag"></i> Heroku</a>
          </div>

        


        
    <div class="post-nav">
      <div class="post-nav-item">
    <a href="/blog/v2ray-brook/" rel="prev" title="Setting Up V2Ray and Brook Proxy Servers">
      <i class="fa fa-chevron-left"></i> Setting Up V2Ray and Brook Proxy Servers
    </a></div>
      <div class="post-nav-item">
    <a href="/blog/parallels-phoenixos-auto-gui/" rel="next" title="Setting Up Phoenix OS on Parallels Desktop for Automatically Entering Graphical Interface on Startup">
      Setting Up Phoenix OS on Parallels Desktop for Automatically Entering Graphical Interface on Startup <i class="fa fa-chevron-right"></i>
    </a></div>
    </div>
      </footer>
    
  </article>
  
  
  

  </div>


          </div>
          
    
  <div class="comments">
    <div id="disqus_thread">
      <noscript>Please enable JavaScript to view the comments powered by Disqus.</noscript>
    </div>
  </div>
  

<script>
  window.addEventListener('tabs:register', () => {
    let activeClass = CONFIG.comments.activeClass;
    if (CONFIG.comments.storage) {
      activeClass = localStorage.getItem('comments_active') || activeClass;
    }
    if (activeClass) {
      let activeTab = document.querySelector(`a[href="#comment-${activeClass}"]`);
      if (activeTab) {
        activeTab.click();
      }
    }
  });
  if (CONFIG.comments.storage) {
    window.addEventListener('tabs:click', event => {
      if (!event.target.matches('.tabs-comment .tab-content .tab-pane')) return;
      let commentClass = event.target.classList[1];
      localStorage.setItem('comments_active', commentClass);
    });
  }
</script>

        </div>
          
  
  <div class="toggle sidebar-toggle">
    <span class="toggle-line toggle-line-first"></span>
    <span class="toggle-line toggle-line-middle"></span>
    <span class="toggle-line toggle-line-last"></span>
  </div>

  <aside class="sidebar">
    <div class="sidebar-inner">

      <ul class="sidebar-nav motion-element">
        <li class="sidebar-nav-toc">
          Table of Contents
        </li>
        <li class="sidebar-nav-overview">
          Overview
        </li>
      </ul>

      <!--noindex-->
      <div class="post-toc-wrap sidebar-panel">
          <div class="post-toc motion-element"><ol class="nav"><li class="nav-item nav-level-2"><a class="nav-link" href="#why-i-made-this-switch"><span class="nav-number">1.</span> <span class="nav-text">Why I Made This Switch</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#differences-between-ibm-cloud-and-heroku"><span class="nav-number">2.</span> <span class="nav-text">Differences Between IBM Cloud and Heroku</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#setting-up-a-new-django-project-using-pycharm"><span class="nav-number">3.</span> <span class="nav-text">Setting Up a New Django Project Using PyCharm</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#preparing-the-project"><span class="nav-number">3.1.</span> <span class="nav-text">Preparing the Project</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#modifying-projects-settings.py"><span class="nav-number">3.2.</span> <span class="nav-text">Modifying Project&#39;s settings.py</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#setting-up-a-new-django-application"><span class="nav-number">4.</span> <span class="nav-text">Setting Up a New Django Application</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#pushing-the-project-to-heroku"><span class="nav-number">5.</span> <span class="nav-text">Pushing the Project to Heroku</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#references"><span class="nav-number">6.</span> <span class="nav-text">References</span></a></li></ol></div>
      </div>
      <!--/noindex-->

      <div class="site-overview-wrap sidebar-panel">
        <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
    <img class="site-author-image" itemprop="image" alt="101对双生儿"
      src="https://tvax4.sinaimg.cn/crop.0.0.568.568.180/6e363801ly8fgtxq4arklj20fs0fsdh8.jpg">
  <p class="site-author-name" itemprop="name">101对双生儿</p>
  <div class="site-description" itemprop="description">A blog of a computer science student.</div>
</div>
<div class="site-state-wrap motion-element">
  <nav class="site-state">
      <div class="site-state-item site-state-posts">
          <a href="/blog/archives/">
        
          <span class="site-state-item-count">12</span>
          <span class="site-state-item-name">posts</span>
        </a>
      </div>
      <div class="site-state-item site-state-categories">
            <a href="/blog/categories/">
          
        <span class="site-state-item-count">4</span>
        <span class="site-state-item-name">categories</span></a>
      </div>
      <div class="site-state-item site-state-tags">
            <a href="/blog/tags/">
          
        <span class="site-state-item-count">14</span>
        <span class="site-state-item-name">tags</span></a>
      </div>
  </nav>
</div>
  <div class="links-of-author motion-element">
      <span class="links-of-author-item">
        <a href="mailto:&#109;&#97;&#111;&#98;&#111;&#119;&#101;&#110;&#51;&#64;&#104;&#111;&#116;&#109;&#97;&#105;&#108;&#46;&#99;&#111;&#109;" title="Email → mailto:&#109;&#97;&#111;&#98;&#111;&#119;&#101;&#110;&#51;&#64;&#104;&#111;&#116;&#109;&#97;&#105;&#108;&#46;&#99;&#111;&#109;" rel="noopener" target="_blank"><i class="fa fa-fw fa-envelope"></i>Email</a>
      </span>
      <span class="links-of-author-item">
        <a href="https://github.com/maobowen" title="GitHub → https://github.com/maobowen" rel="noopener" target="_blank"><i class="fa fa-fw fa-github"></i>GitHub</a>
      </span>
      <span class="links-of-author-item">
        <a href="https://fb.me/maobowen" title="Facebook → https://fb.me/maobowen" rel="noopener" target="_blank"><i class="fa fa-fw fa-facebook"></i>Facebook</a>
      </span>
      <span class="links-of-author-item">
        <a href="https://twitter.com/maobowen3" title="Twitter → https://twitter.com/maobowen3" rel="noopener" target="_blank"><i class="fa fa-fw fa-twitter"></i>Twitter</a>
      </span>
      <span class="links-of-author-item">
        <a href="https://www.linkedin.com/in/bowen-mao" title="LinkedIn → https://www.linkedin.com/in/bowen-mao" rel="noopener" target="_blank"><i class="fa fa-fw fa-linkedin"></i>LinkedIn</a>
      </span>
      <span class="links-of-author-item">
        <a href="https://m.weibo.cn/u/1849047041" title="Weibo → https://m.weibo.cn/u/1849047041" rel="noopener" target="_blank"><i class="fa fa-fw fa-weibo"></i>Weibo</a>
      </span>
      <span class="links-of-author-item">
        <a href="https://www.zhihu.com/people/maobowen3" title="Zhihu → https://www.zhihu.com/people/maobowen3" rel="noopener" target="_blank"><i class="fa fa-fw fa-custom zhihu"></i>Zhihu</a>
      </span>
      <span class="links-of-author-item">
        <a href="https://music.163.com/#/user/home?id=449309413" title="NetEase → https://music.163.com/#/user/home?id=449309413" rel="noopener" target="_blank"><i class="fa fa-fw fa-custom netease"></i>NetEase</a>
      </span>
      <span class="links-of-author-item">
        <a href="https://space.bilibili.com/49932516" title="Bilibili → https://space.bilibili.com/49932516" rel="noopener" target="_blank"><i class="fa fa-fw fa-custom bilibili"></i>Bilibili</a>
      </span>
      <span class="links-of-author-item">
        <a href="https://bangumi.tv/user/451556" title="Bangumi → https://bangumi.tv/user/451556" rel="noopener" target="_blank"><i class="fa fa-fw fa-custom bangumi"></i>Bangumi</a>
      </span>
      <span class="links-of-author-item">
        <a href="https://www.v2ex.com/member/maobowen3" title="V2EX → https://www.v2ex.com/member/maobowen3" rel="noopener" target="_blank"><i class="fa fa-fw fa-custom v2ex"></i>V2EX</a>
      </span>
      <span class="links-of-author-item">
        <a href="http://my.csdn.net/maobowen3" title="CSDN → http://my.csdn.net/maobowen3" rel="noopener" target="_blank"><i class="fa fa-fw fa-custom csdn"></i>CSDN</a>
      </span>
      <span class="links-of-author-item">
        <a href="https://www.youtube.com/channel/UCYc-n4b88MuC-nqrHeSj40g" title="YouTube → https://www.youtube.com/channel/UCYc-n4b88MuC-nqrHeSj40g" rel="noopener" target="_blank"><i class="fa fa-fw fa-youtube"></i>YouTube</a>
      </span>
  </div>



      </div>

    </div>
  </aside>
  <div id="sidebar-dimmer"></div>


      </div>
    </main>

    <footer class="footer">
      <div class="footer-inner">
        

<div class="copyright">
  
  &copy; 2018 – 
  <span itemprop="copyrightYear">2020</span>
  <span class="with-love">
    <i class="fa fa-heart"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">101对双生儿</span>
    <span class="post-meta-divider">|</span>
    <span class="post-meta-item-icon">
      <i class="fa fa-area-chart"></i>
    </span>
    <span title="Symbols count total">54k</span>
    <span class="post-meta-divider">|</span>
    <span class="post-meta-item-icon">
      <i class="fa fa-coffee"></i>
    </span>
    <span title="Reading time total">49 mins.</span>
</div>
  <div class="powered-by">Powered by <a href="https://hexo.io" class="theme-link" rel="noopener" target="_blank">Hexo</a> v4.2.1
  </div>
  <span class="post-meta-divider">|</span>
  <div class="theme-info">Theme – <a href="https://pisces.theme-next.org" class="theme-link" rel="noopener" target="_blank">NexT.Pisces</a> v7.6.0
  </div>

        








      </div>
    </footer>
  </div>

  
  <script src="//cdn.jsdelivr.net/npm/animejs@3.1.0/lib/anime.min.js"></script>
  <script src="//cdn.jsdelivr.net/gh/theme-next/theme-next-pjax@0.2/pjax.min.js"></script>
  <script src="//cdn.jsdelivr.net/npm/jquery@3/dist/jquery.min.js"></script>
  <script src="//cdn.jsdelivr.net/gh/fancyapps/fancybox@3/dist/jquery.fancybox.min.js"></script>
  <script src="//cdn.jsdelivr.net/npm/lozad@1/dist/lozad.min.js"></script>
  <script src="//cdn.jsdelivr.net/npm/velocity-animate@1.2.1/velocity.min.js"></script>
  <script src="//cdn.jsdelivr.net/npm/velocity-animate@1.2.1/velocity.ui.min.js"></script>

<script src="/blog/js/utils.js"></script>

<script src="/blog/js/motion.js"></script>


<script src="/blog/js/schemes/pisces.js"></script>


<script src="/blog/js/next-boot.js"></script>

  <script>
var pjax = new Pjax({
  selectors: [
    'head title',
    '#page-configurations',
    '.content-wrap',
    '.post-toc-wrap',
    '#pjax'
  ],
  switches: {
    '.post-toc-wrap': Pjax.switches.innerHTML
  },
  analytics: false,
  cacheBust: false,
  scrollTo : !CONFIG.bookmark.enable
});

window.addEventListener('pjax:success', () => {
  document.querySelectorAll('script[pjax], script#page-configurations, #pjax script').forEach(element => {
    var code = element.text || element.textContent || element.innerHTML || '';
    var parent = element.parentNode;
    parent.removeChild(element);
    var script = document.createElement('script');
    if (element.id) {
      script.id = element.id;
    }
    if (element.className) {
      script.className = element.className;
    }
    if (element.type) {
      script.type = element.type;
    }
    if (element.src) {
      script.src = element.src;
      // Force synchronous loading of peripheral JS.
      script.async = false;
    }
    if (element.getAttribute('pjax') !== null) {
      element.setAttribute('pjax', '');
    }
    if (code !== '') {
      script.appendChild(document.createTextNode(code));
    }
    parent.appendChild(script);
  });
  NexT.boot.refresh();
  // Define Motion Sequence & Bootstrap Motion.
  if (CONFIG.motion.enable) {
    NexT.motion.integrator
      .init()
      .add(NexT.motion.middleWares.postList)
      .bootstrap();
  }
  NexT.utils.updateSidebarPosition();
});
</script>




  




  
<script src="/blog/js/local-search.js"></script>













    <div id="pjax">
  

  

  

<script>
  function loadCount() {
    var d = document, s = d.createElement('script');
    s.src = 'https://blog-maobowen.disqus.com/count.js';
    s.id = 'dsq-count-scr';
    (d.head || d.body).appendChild(s);
  }
  // defer loading until the whole page loading is completed
  window.addEventListener('load', loadCount, false);
</script>
<script>
  NexT.utils.loadComments(document.querySelector('#disqus_thread'), () => {
    if (window.DISQUS) {
      DISQUS.reset({
        reload: true,
        config: {page: {
            url: "http://bmao.tech/blog/django-pycharm-on-heroku/",
            identifier: "django-pycharm-on-heroku/",
            title: "Deploying PyCharm-Created Django Project on Heroku"
          }
        }
      });
    } else {
      var d = document, s = d.createElement('script');
      s.src = 'https://blog-maobowen.disqus.com/embed.js';
      s.setAttribute('data-timestamp', '' + +new Date());
      (d.head || d.body).appendChild(s);
    }
  });
</script>

    </div>
</body>
</html>
